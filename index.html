<!DOCTYPE html>
<html lang="fa" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>فروشگاه دخانیات فاخر</title>
    <!-- Tailwind CSS CDN for modern, responsive styling -->
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- Google Fonts - Vazirmatn for beautiful Persian typography -->
    <link href="https://fonts.googleapis.com/css2?family=Vazirmatn:wght@300;400;500;600;700;800&display=swap" rel="stylesheet">
    <style>
        /* Apply Vazirmatn font to the entire body for Persian text */
        body {
            font-family: 'Vazirmatn', sans-serif;
            background-color: #121212; /* Deep charcoal background for a luxurious feel */
            color: #e0e0e0; /* Soft white text for readability */
        }

        /* Custom scrollbar for a sleek look */
        ::-webkit-scrollbar {
            width: 8px;
        }
        ::-webkit-scrollbar-track {
            background: #282828; /* Darker track */
            border-radius: 10px;
        }
        ::-webkit-scrollbar-thumb {
            background: #4a4a4a; /* Slightly lighter thumb */
            border-radius: 10px;
        }
        ::-webkit-scrollbar-thumb:hover {
            background: #616161; /* Even lighter on hover */
        }

        /* Keyframe animation for subtle button press effect */
        @keyframes press {
            0% { transform: scale(1); }
            50% { transform: scale(0.98); }
            100% { transform: scale(1); }
        }

        /* Apply animation on button click */
        .btn-press:active {
            animation: press 0.2s ease-in-out;
        }
    </style>
</head>
<body class="min-h-screen flex flex-col">

    <!-- Header Section: Navigation Bar -->
    <header class="bg-gray-900 p-4 shadow-xl">
        <div class="container mx-auto flex justify-between items-center flex-wrap">
            <!-- Brand Logo/Title -->
            <h1 class="text-4xl font-extrabold text-amber-400 mb-2 md:mb-0 transform hover:scale-105 transition duration-300">
                <span class="text-gray-300">فروشگاه</span> دخانیات
            </h1>
            <!-- Navigation Links -->
            <nav>
                <ul class="flex space-x-4 space-x-reverse text-lg">
                    <li><a href="#" class="text-gray-400 hover:text-amber-300 transition duration-300 px-3 py-2 rounded-md">خانه</a></li>
                    <li><a href="#" class="text-gray-400 hover:text-amber-300 transition duration-300 px-3 py-2 rounded-md">محصولات</a></li>
                    <li><a href="#" class="text-gray-400 hover:text-amber-300 transition duration-300 px-3 py-2 rounded-md">تماس با ما</a></li>
                    <li>
                        <!-- Cart Button with dynamic count -->
                        <button id="cart-button" class="relative text-gray-400 hover:text-amber-300 transition duration-300 focus:outline-none p-2 rounded-md btn-press">
                            <!-- Shopping Cart Icon (SVG for scalability and styling) -->
                            <svg xmlns="http://www.w3.org/2000/svg" class="h-7 w-7 inline-block" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 3h2l.4 2M7 13h10l4-8H5.4M7 13L5.4 5.4M7 13l-2.293 2.293c-.63.63-.184 1.707.707 1.707H17m0 0a2 2 0 100 4 2 2 0 000-4zm-8 2a2 2 0 11-4 0 2 2 0 014 0z" />
                            </svg>
                            <!-- Cart Item Count Badge -->
                            <span id="cart-count" class="absolute -top-1 -right-1 bg-red-600 text-white text-xs font-bold rounded-full h-5 w-5 flex items-center justify-center border-2 border-gray-900">0</span>
                        </button>
                    </li>
                </ul>
            </nav>
        </div>
    </header>

    <!-- Main Content Section: Product Grid -->
    <main class="container mx-auto p-6 flex-grow">
        <h2 class="text-5xl font-extrabold text-center text-amber-300 mb-12 mt-8 leading-tight">
            کلکسیون فاخر محصولات ما
        </h2>
        <!-- Product Grid: Responsive layout with Tailwind CSS -->
        <div id="product-grid" class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-8">
            <!-- Products will be dynamically loaded here by JavaScript -->
        </div>
    </main>

    <!-- Cart Modal: Hidden by default, appears on cart button click -->
    <div id="cart-modal" class="fixed inset-0 bg-black bg-opacity-80 flex items-center justify-center z-50 hidden p-4">
        <div class="bg-gray-800 p-8 rounded-xl shadow-2xl w-full max-w-lg max-h-[90vh] overflow-y-auto relative border border-gray-700">
            <!-- Close Modal Button -->
            <button id="close-cart-modal" class="absolute top-4 left-4 text-gray-400 hover:text-red-500 text-3xl font-bold focus:outline-none transition duration-300 btn-press">&times;</button>
            <h3 class="text-3xl font-bold text-amber-300 mb-8 text-center border-b border-gray-700 pb-4">سبد خرید شما</h3>
            <!-- Container for Cart Items -->
            <div id="cart-items" class="space-y-6">
                <!-- Cart items will be dynamically loaded here -->
            </div>
            <!-- Cart Total and Checkout Button -->
            <div class="border-t border-gray-700 pt-6 mt-8 flex justify-between items-center text-2xl font-semibold">
                <span>جمع کل:</span>
                <span id="cart-total" class="text-amber-400">0 تومان</span>
            </div>
            <button id="checkout-button" class="mt-10 w-full bg-amber-600 hover:bg-amber-700 text-white font-bold py-4 px-8 rounded-lg transition duration-300 shadow-lg transform hover:scale-105 focus:outline-none btn-press">
                تکمیل سفارش (نمایشی)
            </button>
        </div>
    </div>

    <!-- Footer Section -->
    <footer class="bg-gray-900 p-6 text-center text-gray-500 text-sm mt-10 shadow-inner">
        <p>&copy; 2025 فروشگاه دخانیات فاخر. تمامی حقوق محفوظ است.</p>
        <p class="mt-3">با عشق و دقت برای شما طراحی شده است.</p>
    </footer>

    <script>
        // Array of sample products for the store
        const products = [
            {
                id: 1,
                name: "سیگار برگ کوبایی",
                price: 1500000,
                image: "https://placehold.co/400x300/212121/e0e0e0?text=Cuban+Cigar", // Placeholder image with matching theme colors
                description: "سیگار برگ دست‌پیچ کوبایی با طعم اصیل و ماندگار، نمادی از تجمل."
            },
            {
                id: 2,
                name: "توتون پیپ عطری",
                price: 850000,
                image: "https://placehold.co/400x300/212121/e0e0e0?text=Aromatic+Pipe+Tobacco",
                description: "توتون باکیفیت و معطر برای پیپ، با رایحه‌ای دلپذیر و آرامش‌بخش."
            },
            {
                id: 3,
                name: "فندک زیپو طلایی",
                price: 2200000,
                image: "https://placehold.co/400x300/212121/e0e0e0?text=Golden+Zippo",
                description: "فندک زیپو با روکش طلایی، طراحی کلاسیک و شعله‌ای پایدار."
            },
            {
                id: 4,
                name: "پیپ دست‌ساز چوبی",
                price: 3500000,
                image: "https://placehold.co/400x300/212121/e0e0e0?text=Handmade+Wooden+Pipe",
                description: "پیپ چوبی دست‌ساز از بهترین چوب‌های گران‌بها، تجربه اسموک بی‌نظیر."
            },
            {
                id: 5,
                name: "سیگار الکترونیکی لوکس",
                price: 1200000,
                image: "https://placehold.co/400x300/212121/e0e0e0?text=Luxury+Vape",
                description: "دستگاه سیگار الکترونیکی با طراحی مدرن و عملکرد عالی."
            },
            {
                id: 6,
                name: "جویس ویپ ممتاز",
                price: 300000,
                image: "https://placehold.co/400x300/212121/e0e0e0?text=Premium+Vape+Juice",
                description: "جویس ویپ با طعم‌های خاص و کیفیت بالا، تجربه بخار بی‌نظیر."
            },
            {
                id: 7,
                name: "کبریت‌های فانتزی",
                price: 50000,
                image: "https://placehold.co/400x300/212121/e0e0e0?text=Fancy+Matches",
                description: "بسته‌های کبریت فانتزی با طرح‌های خاص و شعله‌ای پایدار."
            },
            {
                id: 8,
                name: "پوکه سیگار",
                price: 75000,
                image: "https://placehold.co/400x300/212121/e0e0e0?text=Cigarette+Tubes",
                description: "پوکه‌های سیگار با کیفیت بالا برای پر کردن آسان."
            }
        ];

        // Cart array to store items added by the user
        let cart = [];

        // Get references to DOM elements for manipulation
        const productGrid = document.getElementById('product-grid');
        const cartCountSpan = document.getElementById('cart-count');
        const cartButton = document.getElementById('cart-button');
        const cartModal = document.getElementById('cart-modal');
        const closeCartModalButton = document.getElementById('close-cart-modal');
        const cartItemsContainer = document.getElementById('cart-items');
        const cartTotalSpan = document.getElementById('cart-total');
        const checkoutButton = document.getElementById('checkout-button');

        /**
         * Formats a number as a currency string with commas.
         * @param {number} price - The number to format.
         * @returns {string} The formatted price string.
         */
        function formatPrice(price) {
            return price.toString().replace(/\B(?=(\d{3})+(?!\d))/g, ",");
        }

        /**
         * Renders all products from the 'products' array into the product grid.
         * Creates a card for each product with image, name, description, price, and an "Add to Cart" button.
         */
        function renderProducts() {
            productGrid.innerHTML = ''; // Clear any existing product cards
            products.forEach(product => {
                const productCard = `
                    <div class="bg-gray-800 rounded-xl shadow-lg overflow-hidden transform hover:scale-105 transition duration-300 cursor-pointer border border-gray-700">
                        <img src="${product.image}" alt="${product.name}" class="w-full h-56 object-cover object-center rounded-t-xl">
                        <div class="p-6">
                            <h3 class="text-2xl font-semibold text-amber-300 mb-2">${product.name}</h3>
                            <p class="text-gray-400 text-sm mb-4 h-12 overflow-hidden">${product.description}</p>
                            <div class="flex justify-between items-center mt-4">
                                <span class="text-3xl font-bold text-white">${formatPrice(product.price)} تومان</span>
                                <button data-product-id="${product.id}" class="add-to-cart-btn bg-amber-600 hover:bg-amber-700 text-white font-bold py-3 px-6 rounded-lg transition duration-300 shadow-md transform hover:scale-105 focus:outline-none btn-press">
                                    افزودن به سبد
                                </button>
                            </div>
                        </div>
                    </div>
                `;
                productGrid.innerHTML += productCard;
            });

            // Attach event listeners to all "Add to Cart" buttons after they are rendered
            document.querySelectorAll('.add-to-cart-btn').forEach(button => {
                button.addEventListener('click', (event) => {
                    const productId = parseInt(event.target.dataset.productId);
                    addToCart(productId);
                });
            });
        }

        /**
         * Adds a product to the cart or increments its quantity if already present.
         * @param {number} productId - The ID of the product to add.
         */
        function addToCart(productId) {
            const product = products.find(p => p.id === productId);
            if (product) {
                const existingItem = cart.find(item => item.id === productId);
                if (existingItem) {
                    existingItem.quantity++;
                } else {
                    cart.push({ ...product, quantity: 1 });
                }
                updateCartCount(); // Update the cart icon badge
                renderCartItems(); // Re-render items in the cart modal
            }
        }

        /**
         * Updates the numerical count displayed on the cart icon.
         */
        function updateCartCount() {
            const totalItems = cart.reduce((sum, item) => sum + item.quantity, 0);
            cartCountSpan.textContent = totalItems;
        }

        /**
         * Renders all items currently in the 'cart' array into the cart modal.
         * Also calculates and displays the total price.
         */
        function renderCartItems() {
            cartItemsContainer.innerHTML = ''; // Clear previous cart items
            let total = 0;

            if (cart.length === 0) {
                cartItemsContainer.innerHTML = '<p class="text-center text-gray-400 text-lg py-4">سبد خرید شما خالی است.</p>';
            } else {
                cart.forEach(item => {
                    const cartItemDiv = `
                        <div class="flex items-center justify-between bg-gray-700 p-4 rounded-lg shadow-sm border border-gray-600">
                            <div class="flex items-center">
                                <img src="${item.image}" alt="${item.name}" class="w-20 h-20 object-cover rounded-md ml-4 border border-gray-500">
                                <div>
                                    <h4 class="text-xl font-semibold text-white">${item.name}</h4>
                                    <p class="text-gray-300 text-sm">${formatPrice(item.price)} تومان</p>
                                </div>
                            </div>
                            <div class="flex items-center space-x-3 space-x-reverse">
                                <button data-id="${item.id}" class="quantity-btn bg-gray-600 hover:bg-gray-500 text-white w-9 h-9 rounded-full flex items-center justify-center text-xl font-bold focus:outline-none transition duration-200 btn-press" data-action="decrease">-</button>
                                <span class="text-white text-lg font-bold">${item.quantity}</span>
                                <button data-id="${item.id}" class="quantity-btn bg-gray-600 hover:bg-gray-500 text-white w-9 h-9 rounded-full flex items-center justify-center text-xl font-bold focus:outline-none transition duration-200 btn-press" data-action="increase">+</button>
                                <button data-id="${item.id}" class="remove-from-cart-btn text-red-500 hover:text-red-600 transition duration-300 focus:outline-none ml-2 btn-press">
                                    <!-- Trash Can Icon -->
                                    <svg xmlns="http://www.w3.org/2000/svg" class="h-7 w-7" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16" />
                                    </svg>
                                </button>
                            </div>
                        </div>
                    `;
                    cartItemsContainer.innerHTML += cartItemDiv;
                    total += item.price * item.quantity;
                });
            }

            cartTotalSpan.textContent = `${formatPrice(total)} تومان`;

            // Attach event listeners for quantity adjustment buttons in the cart
            document.querySelectorAll('.quantity-btn').forEach(button => {
                button.addEventListener('click', (event) => {
                    const itemId = parseInt(event.target.dataset.id);
                    const action = event.target.dataset.action; // 'increase' or 'decrease'
                    updateQuantity(itemId, action);
                });
            });

            // Attach event listeners for remove item buttons in the cart
            document.querySelectorAll('.remove-from-cart-btn').forEach(button => {
                button.addEventListener('click', (event) => {
                    const itemId = parseInt(event.target.dataset.id);
                    removeFromCart(itemId);
                });
            });
        }

        /**
         * Updates the quantity of a specific item in the cart.
         * @param {number} itemId - The ID of the item to update.
         * @param {string} action - 'increase' to increment, 'decrease' to decrement.
         */
        function updateQuantity(itemId, action) {
            const itemIndex = cart.findIndex(item => item.id === itemId);
            if (itemIndex > -1) {
                if (action === 'increase') {
                    cart[itemIndex].quantity++;
                } else if (action === 'decrease') {
                    cart[itemIndex].quantity--;
                    if (cart[itemIndex].quantity <= 0) {
                        cart.splice(itemIndex, 1); // Remove item if quantity drops to 0 or less
                    }
                }
                updateCartCount(); // Update cart badge
                renderCartItems(); // Re-render cart modal content
            }
        }

        /**
         * Removes an item completely from the cart.
         * @param {number} itemId - The ID of the item to remove.
         */
        function removeFromCart(itemId) {
            cart = cart.filter(item => item.id !== itemId); // Filter out the item to be removed
            updateCartCount(); // Update cart badge
            renderCartItems(); // Re-render cart modal content
        }

        // Event listener to open the cart modal when the cart button is clicked
        cartButton.addEventListener('click', () => {
            cartModal.classList.remove('hidden'); // Show the modal
            renderCartItems(); // Ensure cart items are up-to-date when modal opens
        });

        // Event listener to close the cart modal when the close button is clicked
        closeCartModalButton.addEventListener('click', () => {
            cartModal.classList.add('hidden'); // Hide the modal
        });

        // Event listener to close the cart modal when clicking outside the modal content
        cartModal.addEventListener('click', (event) => {
            if (event.target === cartModal) { // Check if the click was directly on the modal background
                cartModal.classList.add('hidden'); // Hide the modal
            }
        });

        // Event listener for the "Checkout" button (demonstration purposes only)
        checkoutButton.addEventListener('click', () => {
            if (cart.length > 0) {
                // Using a custom alert-like message for better UX than browser's alert()
                const messageBox = document.createElement('div');
                messageBox.className = 'fixed inset-0 bg-black bg-opacity-70 flex items-center justify-center z-50';
                messageBox.innerHTML = `
                    <div class="bg-gray-800 p-8 rounded-lg shadow-xl text-center border border-gray-700">
                        <p class="text-white text-xl mb-6">سفارش شما با موفقیت ثبت شد!</p>
                        <p class="text-gray-400 text-sm mb-6">(این یک پیام نمایشی است و پرداخت واقعی انجام نمی‌شود.)</p>
                        <button class="bg-amber-600 hover:bg-amber-700 text-white font-bold py-2 px-6 rounded-lg transition duration-300 btn-press" onclick="this.parentElement.parentElement.remove()">متو